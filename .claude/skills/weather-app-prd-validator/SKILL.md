---
name: weather-app-prd-validator
description: Validate weather app PRDs for completeness, consistency, testability, and feasibility aligned to the mobile weather PRD template. Use when the user mentions weather app/system weather PRD review/validation, acceptance criteria, edge cases, alerts, precipitation reminders, life indices, widgets, location, data metrics, tracking, privacy compliance, or readiness for development.
---

# 天气 App PRD 校验（weather-app-prd-validator）

## 快速开始

当用户提供天气 App（系统天气）相关 PRD，或提出"校验/评审/验收标准/边界条件/埋点/预警/生活指数/降雨提醒/桌面组件/定位"等需求时，使用本技能。

**核心目标**：
- 对照天气 PRD 模版做**硬校验**（缺失即 P0/P1）。
- 做**天气领域专项校验**（数据口径/定位/预警通知/生活指数/弱网离线/端侧能力/NFR/合规）。
- 输出可直接落回 PRD 的**可复制改写片段**，让文档"可开发、可测试、可验收"。

## 关键约束（防编造 / 防拍脑袋）

### 不得虚构的内容（缺失就写"待确认"）

以下内容**禁止**在没有来源时自行补齐或编造；若 PRD 未给出，必须进入"待确认信息"，并给出需要用户补充的具体位置/字段：
- **预警类型/等级/颜色枚举**（必须引用权威枚举或 `../天气需求文档/reference.md`）
- **生活指数等级体系与阈值规则**（尤其"≥4 展示"类，必须先定义枚举/映射/归一化）
- **数据字段来源与口径**（降水概率/雨量、AQI 阈值、风力单位等）
- **性能/时延阈值**（除非 PRD 明确或用户给出指标目标）

## 输入要求（缺失则在输出中列为"待确认信息"）

优先从 PRD 中提取；如果用户只给了片段，也可先做部分校验：
- PRD 的章节目录或全文（至少包含：`1.1`、PR 稿、`4.1/4.2`、`5.2/5.3`、`6.x`、`7.x`）
- 平台与版本：iOS/Android/系统版本、是否含桌面组件/负一屏/通知等
- 天气数据与服务：供应商（华风/墨迹/双源）、更新频率、缓存策略（若 PRD 未写则标记）
- 预警：是否涉及预警卡/通知 push/订阅与频控

## 严重度分级（用于排序与就绪度结论）

- **P0 阻塞**：无法开发/无法验收/高风险合规；必须先补齐
- **P1 严重**：高概率返工或线上风险；建议开工前补齐
- **P2 一般**：影响体验或可测性；可并行补齐
- **P3 轻微**：表述/格式/可读性
- **建议**：可选优化

## 校验流程（按顺序执行）

### Step 0：建立 PRD 结构映射（按模版章节）

按《天气需求文档》技能定义的模版章节顺序建立索引，至少覆盖：
- `1.1 需求规格信息`
- `（二）产品PR稿（必填）`
- `3.1/3.2 产品策略`
- `4.1 验收标准`、`4.2 MOS`
- `5.1/5.2/5.3 产品方案设计`
- `6.1/6.2/6.3 隐私合规与进网要求`
- `7.1~7.6 非功能需求说明`
- `8.x 附录`

### Step 0.5：快速风险扫描（30 秒）

在深入逐章前，先快速判断是否存在"一票否决"类风险：
- PRD 仅有概念描述，无可落地功能清单/流程/验收 → 直接 **Not ready**
- 涉及定位/推送/第三方 SDK，但 `6.x` 合规表格未填或为空 → **P0**
- MOS/验收指标写了"看板指标"，但 `7.2 埋点需求` 没有事件与口径 → **P0/P1**
- 出现超长 `data:image/*;base64,...` 直接粘贴在 PRD → 标记为 **P2**（建议改为链接/占位）

### Step 1：模版必填项硬校验（P0/P1 Gate）

按《天气需求文档》的模版要求做硬校验。**缺失即阻塞（P0）或高返工（P1）**：

| GateID | 章节/项 | 严重度 | 缺失判定（任一命中即算缺失） | 备注/改写方向 |
|---|---|---|---|---|
| G1 | `1.1 需求规格信息`（表格） | P0 | 无表格/关键字段为空（需求名称、OS版本、等级、上线时间、适用范围等） | 直接补齐表格字段，明确 In/Out scope |
| G2 | 产品 PR 稿（导语/原点用户/痛点/成功指标） | P0 | 没有"原点用户+核心场景+痛点"或没有"如何衡量成功" | 用用户洞察或场景化故事补齐，并把指标落到 MOS/埋点 |
| G3 | `3.2 核心产品策略` | P0 | 策略缺失或仅口号，无"策略→解决的问题" | 每条策略写清"解决什么问题/覆盖哪些功能点" |
| G4 | `4.1 验收标准` | P0 | 只有"更好/更准/更流畅"等不可测试表述 | 每个原子需求至少 1 条 GWT；补性能/弱网/权限拒绝 |
| G5 | `5.1 产品整体示意` | P0 | 无流程/交互示意/时序图或链接 | 用流程图或主链路步骤补齐 |
| G6 | `5.2 功能清单` | P0 | 无 feature 列表/无优先级/无法拆分需求边界 | 先拆原子需求并标 P0/P1/P2 |
| G7 | `5.3 功能详细说明` | P0 | 缺规则/状态（加载/空/错）/边界（弱网/离线/失败） | 按"触发-状态-规则-兜底-验收-埋点"补齐 |
| G8 | `6.x 隐私合规与进网要求`（表格） | P0 | 表格项空着或无"是/否"结论；涉及定位/推送/SDK 但未说明 | 明确数据变化、目的、最小化、拒绝路径、文案 |
| G9 | `7.1 依赖硬件/能力/软件` | P0 | 依赖项未填"是/否"或未说明依赖内容 | 写清定位/通知/后台刷新/供应商等依赖 |
| G10 | `4.2 MOS` | P1 | 有目标但无量化阈值/无验收方式/无最终验收时间 | 补"指标-口径-数据来源-验收方式-时间点" |
| G11 | `7.2 埋点需求` | P1 | MOS/验收依赖数据，但无事件/属性/触发时机/口径 | 给出事件表，保证可计算 MOS |
| G12 | `7.4 升级与回落` | P1 | 有入口/形态/数据源变更但无回落策略 | 写清灰度、开关、回滚范围 |
| G13 | `7.5 需求检查项` | P1 | 暗色模式/无障碍/国际化等检查表未结论 | 逐项填"是/否/N/A"，补说明 |

### Step 2：拆成原子需求并检查"可测试性"

把 PRD 拆为原子需求（页面/入口/流程/规则/数据/接口/埋点/非功能），逐条问：
- **触发条件是什么**（谁、何时、在哪个入口）
- **系统做什么**（状态变化、UI 变化、请求与缓存）
- **用户看到什么**（文案、兜底、可操作按钮）
- **如何验收**（Given/When/Then 或条件-动作-结果）

任何"更好/更准/更流畅/更直观"必须落到可度量口径或可复现用例。

### Step 3：一致性与口径检查

检查全篇是否前后矛盾或口径不一：
- 同一概念是否多名（例如"降雨提醒/转雨提醒/降水卡"）
- 单位/时区/语言/温度制（℃/℉）是否统一，是否支持切换
- 指标与埋点是否支撑 MOS 与验收（不能"写了指标但无采集"）

### Step 4：天气专项校验（重点，可勾选 Checklist）

按下列维度补齐"天气业务的高风险缺口"：

#### A. 天气数据源与口径
- [ ] 供应商：华风/墨迹/双源切换；是否写清切换策略、灰度与回落
- [ ] 刷新：前台进入/下拉刷新/定时更新触发；失败重试与限流
- [ ] 缓存：有效期、过期提示、离线兜底（展示上次更新时间）
- [ ] 字段口径：降水（概率/雨量/开始结束）、风力（单位/阵风）、AQI（等级阈值/污染物项）、体感/湿度/能见度的来源与展示规则
- [ ] 数据缺失：某字段无值/延迟/异常时的 UI 与文案（不要空白）

#### A.1 降雨提醒（常见高频需求的最小可测规格）
- [ ] 触发条件：城市/定位范围、阈值（概率/雨量/时间窗口）、数据源
- [ ] 触发时机：前台刷新/后台定时/系统推送；频控（冷却、每日上限）
- [ ] 用户动作：点击跳转、关闭/取消订阅、再次开启的策略
- [ ] 失败兜底：无网/定位失败/数据缺失/权限拒绝时提示与降级
- [ ] 验收：至少覆盖"触发/不触发/重复触发抑制/跨城/离线"用例

#### B. 定位与多城市管理
- [ ] 权限：定位申请时机、拒绝/仅一次/系统关闭的引导与手动选城兜底
- [ ] 多城市：搜索/收藏/排序/删除/去重/同名城市区分（省市区）
- [ ] 时区：跨时区城市的"今日/逐小时/日出日落"按城市时区计算
- [ ] 单位：℃/℉、风速单位等切换与持久化
- [ ] 首次使用：无历史城市时的默认态与引导路径

#### C. 预警与通知（强一致性）
- [ ] 枚举：预警类型/等级/颜色来自权威枚举（缺失→待确认，不编造）
- [ ] 触达：订阅/频控/免打扰/到达时延目标/点击去向
- [ ] 强提醒边界：哪些必须 push，哪些仅卡片；撤销/解除策略
- [ ] 多条并存：排序、折叠、最高等级优先规则
- [ ] 跨城市：收藏城市是否推送/展示（若支持订阅则写清）

#### C.1 预警验收用例覆盖（最小集合）
- [ ] 预警新增：出现位置、文案、图标与点击跳转正确
- [ ] 生效中：刷新后仍保持一致，不重复打扰（按频控）
- [ ] 解除/过期：卡片/列表消失规则与提示（如有）明确
- [ ] 弱网/离线：展示上次状态与更新时间，不空白

#### D. 生活指数与卡片策略
- [ ] 指数等级：枚举/含义明确（尤其墨迹多档 vs 1–5 归一化）
- [ ] 阈值触发：写清映射/归一化方案；否则进入"待确认"
- [ ] 卡片优先级：冲突解决与兜底（出现/消失/频控/跳转）
- [ ] 文案一致：等级对应文案、面向用户的可行动建议
- [ ] 数据缺失：指数无值/服务不可用时兜底策略

#### D.1 轮播位卡片规则的必写字段（建议作为改写模板）
- 卡片名称/类型
- 展示触发阈值与口径（数据源、等级枚举/映射）
- 展示频控（冷却时间、每日上限、是否跟随刷新重置）
- 冲突策略（优先级、覆盖/排队、兜底）
- 点击行为（跳转目标、回退路径）

#### E. 端侧能力与体验一致性
- [ ] 桌面组件/负一屏：信息密度、刷新时机、点击跳转、主题/深色模式
- [ ] 通知样式：标题/摘要/展开、点击去向、权限拒绝与引导
- [ ] 趋势可视化：默认指标、切换交互、可访问性、性能约束

#### F. 非功能与工程可行性（NFR）
- [ ] 性能：首屏/刷新耗时阈值、列表滚动/图表渲染目标
- [ ] 稳定性：失败率、重试、服务降级、灰度与回滚
- [ ] 耗电/流量：后台刷新预算、定位频率、资源策略
- [ ] 兼容：系统版本/机型/折叠屏/分屏/横竖屏（按适用写）

#### G. 合规与安全（必须可审计）
- [ ] 权限与数据：定位/推送/设备信息的采集目的、最小化、弹窗文案、拒绝路径
- [ ] 埋点与日志：脱敏、采样、可关闭、保留周期（按模板）
- [ ] 第三方 SDK：新增/变更说明与进网要求（如适用）

### Step 5：形成输出（强制模板）

输出必须包含以下 4 块：结论、评分卡、逐章点评、问题清单与可复制改写。

## 输出模板（强制使用此结构）

按以下 Markdown 模板输出（标题保持一致，便于复制/复审）：

```markdown
## PRD 校验结论
- 就绪度：Ready / Needs work / Not ready
- 阻塞项数量：P0 x 项，P1 x 项
- 总体风险：低/中/高（1 句话说明最高风险）

## 章节覆盖率（是否可评审）
| 章节 | 是否存在 | 是否可验收 | 主要缺口（一句话） |
|---|---|---|---|
| 1.1 需求规格信息 |  |  |  |
| 产品PR稿 |  |  |  |
| 3.2 核心策略 |  |  |  |
| 4.1 验收标准 |  |  |  |
| 4.2 MOS |  |  |  |
| 5.1 整体示意 |  |  |  |
| 5.2 功能清单 |  |  |  |
| 5.3 功能详细说明 |  |  |  |
| 6.x 合规与进网 |  |  |  |
| 7.2 埋点需求 |  |  |  |
| 7.4 升级与回落 |  |  |  |
| 7.5 需求检查项 |  |  |  |

## 评分卡（0-5 分）
| 维度 | 分数 | 一句话理由 |
|---|---:|---|
| 模版完整度（硬校验） |  |  |
| 可测试性（验收标准质量） |  |  |
| 数据口径与准确性策略 |  |  |
| 定位/多城市/时区与单位 |  |  |
| 预警与通知策略 |  |  |
| 生活指数/卡片规则 |  |  |
| NFR（性能/稳定/降级） |  |  |
| 合规与安全 |  |  |

## 待确认信息（缺什么列什么）
- ...

## 逐章点评（按模版顺序）
### 1.1 需求规格信息
- ✅ 已覆盖：
- ⚠️ 问题：
- ✅ 建议改写：

### （二）产品PR稿
- ...

### 4.1 验收标准 / 4.2 MOS
- ...

### 5.2 功能清单 / 5.3 功能详细说明
- ...

### 6.x 隐私合规与进网要求
- ...

### 7.x 非功能需求说明
- ...

## 问题清单（按 P0→P3→建议排序）
| ID | 位置/章节 | 类型 | 严重度 | 问题描述 | 风险 | 建议修正（可直接改写） |
|---|---|---|---|---|---|---|
| 1 |  | 可测试性/一致性/流程/数据/预警/指数/NFR/合规 | P0 |  |  |  |

## 建议补充的 PRD 文案（可复制回 PRD）
### 1) 验收标准（示例格式）
- Given ... When ... Then ...
- 覆盖：主流程/异常/边界/权限/性能/弱网/离线

### 2) 边界与异常处理（示例格式）
- 空态：
- 错误态：
- 弱网/离线：
- 超时/重试：
- 幂等/重复提交：
- 权限拒绝（定位/通知）：

### 3) 数据口径/埋点（如适用）
- 数据源与口径：
- 字段定义：
- 事件列表（事件名/触发时机/属性/口径/采样）：
```

## 常见"不可测试"表述 → 改写规则

- "更准确/更准" → 明确：数据源、刷新频率、对比基准、误差口径（例如降雨开始/结束时间误差 ≤ x 分钟）
- "更流畅" → 明确：首屏耗时 ≤ x ms、滚动掉帧率 ≤ x%、图表渲染 ≤ x ms
- "更直观" → 明确：信息架构（减少步骤）、默认展示指标、可视化交互与可访问性要求
- "适当提示" → 明确：触发条件、展示位置、文案、消失条件、可点击动作、频控

## 额外资源

需要引用模版结构与口径时，优先阅读：
- `../天气需求文档/SKILL.md`
- `../天气需求文档/reference.md`

## 可复制模板库（用于"建议补充的 PRD 文案"）

> 目的：把"该写什么"变成可直接粘回 `5.3`/`4.1` 的最小可测模板。

### 模板 1：降雨提醒（写进 5.3）

```markdown
#### 降雨提醒：需求规则（最小可测规格）
- 数据源：华风/墨迹/双源（写明）｜字段：降水概率(%)/雨量(mm)/开始-结束时间
- 触发条件：未来 X 小时内降水概率 ≥ A%（或雨量 ≥ Bmm），且用户已开启提醒
- 触发时机：前台刷新/后台定时/系统推送（写明），刷新频率：每 N 分钟（写明或待确认）
- 频控：同一城市冷却 T 分钟；每日最多 K 次；解除条件（雨停/概率低于阈值/用户关闭）
- 通知文案：标题/摘要/可点击动作（跳转到：分钟级/小时详情/预警详情）
- 失败兜底：无网/定位失败/数据缺失/权限拒绝 → 展示上次更新时间 + 引导文案 + 降级方案
```

### 模板 2：预警（卡片+列表+通知）

```markdown
#### 气象预警：展示与通知规则
- 口径来源：预警类型与等级枚举（引用文件/链接）
- 展示位置：首页预警卡/预警列表/详情页（写明）
- 排序与折叠：按等级优先，其次按生效时间；同城多条的折叠规则
- 通知策略：哪些等级强提醒；频控（冷却/每日上限）；免打扰处理
- 状态机：新增/生效中/解除(过期) 的 UI 变化与通知撤销规则
```

### 模板 3：生活指数（等级映射+阈值）

```markdown
#### 生活指数：等级口径与展示规则
- 服务来源：华风/墨迹/双源（写明），若双源需写切换/灰度/回落
- 等级体系：枚举（原生/归一化到 1–5）与映射表（如适用）
- 展示阈值：例如"等级 ≥ 4 展示"（必须基于映射/归一化后的等级）
- 文案：每个等级的提示语与可行动建议
- 数据缺失兜底：无值/服务不可用时的 UI 与文案
```

### 模板 4：定位失败/权限拒绝（最小闭环）

```markdown
#### 定位与权限：失败路径闭环
- 申请时机：首次打开/点击定位按钮/进入某功能（写明）
- 拒绝处理：提示文案 + 去设置引导 + 手动选城入口
- 默认态：无定位无历史城市时展示默认城市或引导页
- 验收：拒绝/仅一次/系统关闭定位/定位超时的用例覆盖
```

### 模板 5：离线/弱网与缓存

```markdown
#### 弱网/离线/缓存：展示策略
- 缓存有效期：N 分钟；过期提示：展示"上次更新时间"
- 离线：展示缓存核心字段（温度/天气/预警），其余置灰并提供重试
- 失败重试：退避策略与最大次数；避免无限重试耗电耗流量
```
